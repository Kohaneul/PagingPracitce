<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.demo.web.MemberRepository">
    <select id="findAll" resultType="com.example.demo.domain.Member" parameterType="com.example.demo.dto.SearchDTO" >
        select rn.* from
        (select @rownum := @rownum+1 as rownum , m.* from member m, (select @rownum :=0) r
        ) rn
        <where>
            <if test="loginId!=null and loginId!=''">
                rn.loginId like concat('%',#{loginId},'%')
            </if>
            <if test="name!=null and name!=''">
               and rn.name like concat('%',#{name},'%')
            </if>
        </where>
        limit #{pagination.recordSize}
        offset #{pagination.offset}
       ;
    </select>

    <select id="count" resultType="int">
        select count(*) from member;
    </select>



</mapper>